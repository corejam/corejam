type CanvasPeer {
  hash: String!
  offer: JSONObject!
}

input CanvasPeerInput {
  hash: String!
  offer: JSONObject!
}

# This is the room that delegates the offers to each other.
type CanvasPeers {
  key: String!
  peers: [CanvasPeer!]
}

type CanvasPage implements Timestamp @cacheControl(maxAge: 300) {
  id: String!
  canvas: JSONObject
  seo: SEO
  peers: CanvasPeers
  dateCreated: String!
  dateUpdated: String!
}

input CanvasPageInput {
  seo: SEOInput
  canvas: JSONObject
}

type CanvasPageList implements Paginated {
  totalItems: Int!
  perPage: Int!
  currentPage: Int!
  lastPage: Int!
  items: [CanvasPage]
}

type Config @cacheControl(maxAge: 3600) {
  seo: SEO!
  general: ConfigGeneral!
  layout: ConfigLayout!
}

type ConfigLayout @cacheControl(maxAge: 3600) {
  header: JSONObject
  footer: JSONObject
}

type ConfigGeneral @cacheControl(maxAge: 3600) {
  admin_email: String!
}

input ConfigGeneralInput {
  admin_email: String!
}

input ConfigInput {
  seo: SEOInput!
  general: ConfigGeneralInput!
}

type Image implements Timestamp @cacheControl(maxAge: 3600) {
  src: String!
  public_id: String!
  alt: String
  mimetype: String!
  dateCreated: String!
  dateUpdated: String!
}

input ImageInput {
  public_id: String!
  resource_type: String!
  src: String!
  alt: String
  mime_type: String
}

# The `JSONObject` scalar type represents JSON objects as specified by [ECMA-404](http://www.ecma-international.org/publications/files/ECMA-ST/ECMA-404.pdf).
scalar JSONObject

type Mutation {
  dummy: String
  updateConfig(configInput: ConfigGeneralInput!): Config
  updateConfigSEO(seoInput: SEOInput!): Config
  cacheFlush: Boolean
  canvasPageCreate(
    canvasPageInput: CanvasPageInput!
    seoInput: SEOInput!
  ): CanvasPage
  canvasPageEditSEO(id: String!, seoInput: SEOInput!): CanvasPage
  canvasPageEdit(id: String!, canvasPage: CanvasPageInput!): CanvasPage
  canvasOpenPeers(id: String!, peerInput: CanvasPeerInput!): CanvasPeers
  canvasPollPeers(id: String!): CanvasPeers
  canvasClosePeers(id: String!): CanvasPage
}

interface Paginated {
  totalItems: Int!
  perPage: Int!
  currentPage: Int!
  lastPage: Int!
  items: [Timestamp]
}

type Query {
  dummy: String
  config: Config
  objectFromURL(url: String!): SEODocument @cacheControl(maxAge: 300)
  allCanvasPages: [CanvasPage]
  paginateCanvasPages(page: Int!, size: Int!): CanvasPageList
  canvasPageById(id: String!): CanvasPage
  canvasPollPeers(id: String!): CanvasPeers
}


type SEO @cacheControl(maxAge: 3600) {
  metaTitle: String
  metaDescription: String
  keywords: [String]
  url: String!
}

type SEODocument {
  canvasPage: CanvasPage
}

input SEOInput {
  metaTitle: String
  metaDescription: String
  keywords: [String]
  url: String!
}

interface Timestamp {
  dateCreated: String
  dateUpdated: String
}
